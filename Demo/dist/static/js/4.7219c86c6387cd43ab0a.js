webpackJsonp([4],{"6/MQ":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("bOdI"),o=s.n(a),r={components:{SolidButton:s("Tftl").a},data:function(){var t;return t={textarea:"",name:"",status:[],user:[],system:[],keys:[],list:[],form:{id:"",status:"1",name:"",description:"",auths:""}},o()(t,"list",[]),o()(t,"defaultProps",{children:"children",label:"authName"}),o()(t,"sysId",""),o()(t,"sysName",""),o()(t,"ids",[]),o()(t,"roleId",""),o()(t,"idList",[]),t},methods:{loadData:function(){var t=this,e=this;void 0!=e.roleId?e.$api.post("role/query",{id:e.roleId},function(s){e.form.status=s.repData.role.status.toString(),e.form.name=s.repData.role.name,e.form.description=s.repData.role.description,""!=s.repData.sys&&(e.sysId=s.repData.sys[0].id,e.$api.post("role/doAuthBySysId",{sysId:t.sysId},function(s){t.list=s.repData;for(var a=0;a<t.list.length;a++)t.idList.push(t.list[a].id);e.$api.post("role/doRoleAuth",{roleId:t.roleId},function(s){if(""!=s.repData){for(var a=s.repData,o=[],r=0;r<a.length;r++)for(var i=0;i<t.idList.length;i++)if(a[r].authId===t.idList[i]){a.splice(r,1);break}for(var n=0;n<a.length;n++)o.push(a[n].authId);t.keys=o,t.form.auths=t.keys.toString()}e.$api.post("role/doAuthBySysId",{sysId:t.sysId},function(e){t.list=e.repData},function(e){t.$message({message:e.repData.repMsg,type:"error"})})},function(t){})},function(e){t.$message({message:e.repData.repMsg,type:"error"})}))},function(e){t.$message({message:e.repData.repMsg,type:"error"})}):(e.form.status="",e.form.name="",e.form.description="",e.form.id=""),e.$api.post("role/querystatus",{},function(t){e.status=t.repData},function(t){console.log(t)}),e.$api.post("org/queryOrgByUserId",{},function(t){e.user=t.repData},function(t){console.log(t)}),e.$api.post("role/queryallsys",{},function(s){e.system=s.repData,e.sysName=s.repData[0].name,""!=t.sysId&&t.$api.post("role/doAuthBySysId",{sysId:t.sysId},function(e){t.list=e.repData},function(t){console.log(t)})},function(t){console.log(t)})},upper:function(){this.$router.push({path:"/RoleManage",query:{}})},chosesys:function(t){var e=this;console.log(t),this.sysId=t.id,this.sysName=t.name;for(var s=0;s<this.system.length;s++)document.getElementById(this.system[s].id).className="";document.getElementById(t.id).className="span",this.$api.post("role/doAuthBySysId",{sysId:this.sysId},function(t){e.list=t.repData},function(t){console.log(t)})},getCheckedKeys:function(){for(var t=this,e=this.$route.query.id,s=this.$refs.tree.getCheckedNodes(),a=[],o=[],r=0;r<s.length;r++){a.push(s[r].pId),a.push(s[r].id);for(var i=0;i<a.length;i++)null==a[i]&&a.splice(i,1),-1==o.indexOf(a[i])&&o.push(a[i])}this.form.auths=o.toString(),""!=this.form.name?""!=this.form.status?void 0!=e?this.$api.post("role/update",this.form,function(e){t.$message({message:"修改成功",type:"success"}),t.upper()},function(t){console.log(t)}):this.$api.post("role/save",this.form,function(e){t.$message({message:"新增成功",type:"success"}),t.upper()},function(t){console.log(t)}):this.$message({message:"请选择状态",type:"warning"}):this.$message({message:"角色名称不能为空",type:"warning"})}},created:function(){this.roleId=this.$route.query.id,this.form.id=this.$route.query.id,this.loadData()}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{width:"100%",background:"#fff",height:"100%"}},[s("div",{staticClass:"top"},[s("el-button",{attrs:{type:"text"},on:{click:t.upper}},[t._v("返回")])],1),t._v(" "),s("el-row",{attrs:{gutter:0}},[s("el-col",{attrs:{span:7}},[s("div",{staticClass:"grid-content bg-purple"},[s("p",{staticClass:"prompt"},[t._v("第一步：新建角色")]),t._v(" "),s("div",{staticClass:"public"},[s("span",{staticClass:"system"},[t._v("角色名称")]),t._v(" "),s("el-input",{attrs:{placeholder:"请输入角色名称",clearable:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),s("div",{attrs:{id:"public"}},[s("span",{staticClass:"system"},[t._v("状态")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择状态"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.status,function(t){return s("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}))],1),t._v(" "),s("div",{staticClass:"public"},[s("span",{staticClass:"system"},[t._v("角色描述")]),t._v(" "),s("el-input",{attrs:{type:"textarea",resize:"none",rows:4,placeholder:"请输入描述"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)])]),t._v(" "),s("el-col",{attrs:{span:7}},[s("div",{staticClass:"grid-content bg-purple"},[s("p",{staticClass:"prompt"},[t._v("第二步：选择系统")]),t._v(" "),t._l(t.system,function(e){return s("div",{staticClass:"button",attrs:{round:""}},[s("span",{attrs:{id:e.id},domProps:{textContent:t._s(e.name)},on:{click:function(s){t.chosesys(e)}}})])})],2)]),t._v(" "),s("el-col",{attrs:{span:8}},[s("div",{staticClass:"grid-content bg-purple"},[s("p",{staticClass:"prompt"},[t._v("第三步：选择对应系统的权限树")]),t._v(" "),s("el-tree",{ref:"tree",attrs:{data:t.list,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":t.keys,props:t.defaultProps}})],1)])],1),t._v(" "),s("div",{staticClass:"footer"},[s("el-button",{staticClass:"button-solid",on:{click:t.getCheckedKeys}},[t._v("保存配置")])],1)],1)},staticRenderFns:[]};var n=s("VU/8")(r,i,!1,function(t){s("JStU")},"data-v-ce8b5a8c",null);e.default=n.exports},"9bBU":function(t,e,s){s("mClu");var a=s("FeBl").Object;t.exports=function(t,e,s){return a.defineProperty(t,e,s)}},C4MV:function(t,e,s){t.exports={default:s("9bBU"),__esModule:!0}},JStU:function(t,e){},bOdI:function(t,e,s){"use strict";e.__esModule=!0;var a,o=s("C4MV"),r=(a=o)&&a.__esModule?a:{default:a};e.default=function(t,e,s){return e in t?(0,r.default)(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}},mClu:function(t,e,s){var a=s("kM2E");a(a.S+a.F*!s("+E39"),"Object",{defineProperty:s("evD5").f})}});
//# sourceMappingURL=4.7219c86c6387cd43ab0a.js.map